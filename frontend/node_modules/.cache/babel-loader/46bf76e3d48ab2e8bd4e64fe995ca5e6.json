{"ast":null,"code":"export const placeReducer = (state, action) => {\n  switch (action.type) {\n    case 'SHOW_PLACES':\n      const {\n        compiledData,\n        days,\n        location\n      } = action.search;\n      const placesLoaded = loadPlaces(state, compiledData, days, location);\n      return placesLoaded;\n\n    case 'ADD_EXTRA_DAY':\n      const extraDay = addExtraDay(state);\n      return extraDay;\n\n    case 'CHANGE_ORDER':\n      const {\n        newOrder\n      } = action.order;\n      return newOrder;\n\n    case 'LOAD_ITINERARY':\n      const {\n        itinerary\n      } = action.payload;\n      console.log(\"from reducer:\", itinerary);\n      loadItinerary(state, itinerary);\n      return state;\n\n    default:\n      return state;\n  }\n};\n\nconst loadItinerary = async (state, itinerary) => {\n  let columns = {};\n  let dayBoards = [];\n  let categoryBoards = [];\n  let placesFetched = {};\n  const googlePlacesApi = process.env.REACT_APP_GOOGLE_PLACES_API_KEY;\n  const dayPlans = itinerary.dayPlans;\n\n  for (var i = 0; i < dayPlans.length; i++) {\n    let dayObject = {};\n    dayObject['id'] = `day-${i}`;\n    dayObject['title'] = `Day ${i + 1}`;\n    dayObject['placeIds'] = [];\n    columns[`day-${i}`] = dayObject;\n    dayBoards.push(`day-${i}`);\n  }\n\n  for (var i = 0; i < dayPlans.length; i++) {\n    const placeIds = dayPlans[i].placeIds;\n    columns[`day-${i}`].placeIds = placeIds;\n\n    for (var j = 0; j < placeIds.length; j++) {\n      const response = await fetch(`/place/details/json?placeid=${placeIds[j]}&key=${googlePlacesApi}`);\n      const data = await response.json();\n      let placeObject = {};\n      placeObject['id'] = placeIds[j];\n      placeObject['content'] = data.result.name;\n      placeObject['rating'] = data.result.rating;\n      placeObject['photoRef'] = data.result.photos ? data.result.photos[0].photo_reference : \"0\";\n      placeObject['location'] = data.result.geometry.location; //console.log(placeObject);\n\n      placesFetched[placeIds[j]] = placeObject;\n    }\n  } //console.log(columns);\n  //console.log(placesFetched);\n\n\n  const newState = { ...state,\n    days: dayPlans.length + 1,\n    location: itinerary.city,\n    places: placesFetched,\n    columns: { ...state.columns,\n      ...columns\n    },\n    dayBoards: [...dayBoards],\n    categoryBoards: [...categoryBoards]\n  };\n  console.log(newState);\n};\n\nconst addExtraDay = state => {\n  const nextColumnIndex = state.dayBoards.length;\n  const nextColumn = {\n    id: `day-${nextColumnIndex}`,\n    title: `Day ${nextColumnIndex + 1}`,\n    placeIds: []\n  };\n  const newState = { ...state,\n    days: nextColumnIndex + 1,\n    columns: { ...state.columns,\n      [`day-${nextColumnIndex}`]: nextColumn\n    },\n    dayBoards: [...state.dayBoards, `day-${nextColumnIndex}`]\n  };\n  console.log(newState);\n  return newState;\n};\n\nconst loadPlaces = (state, compiledData, days, location) => {\n  let columns = {};\n  let dayBoards = [];\n  let categoryBoards = [];\n\n  for (var i = 0; i < days; i++) {\n    let dayObject = {};\n    dayObject['id'] = `day-${i}`;\n    dayObject['title'] = `Day ${i + 1}`;\n    dayObject['placeIds'] = [];\n    columns[`day-${i}`] = dayObject;\n    dayBoards.push(`day-${i}`);\n  }\n\n  let placesFetched = {};\n  const placeTypes = ['Restaurants', \"Hotels\", \"Tourist+attraction\"];\n\n  for (var c = 0; c < compiledData.length; c++) {\n    let data = compiledData[c];\n    let placeIds = [];\n\n    for (var j = 0; j < data.results.length; j++) {\n      //object structure of place card is set here\n      var placeObject = {};\n      placeObject['id'] = data.results[j].place_id;\n      placeObject['content'] = data.results[j].name;\n      placeObject['rating'] = data.results[j].rating;\n      placeObject['photoRef'] = data.results[j].photos ? data.results[j].photos[0].photo_reference : \"0\";\n      placeObject['location'] = data.results[j].geometry.location; //console.log(placeObject);\n\n      placeIds.push(data.results[j].place_id);\n      placesFetched[data.results[j].place_id] = placeObject;\n    }\n\n    columns[`category-${c + 1}`] = {\n      id: `category-${c + 1}`,\n      title: `${placeTypes[c]}`,\n      placeIds: placeIds\n    };\n    categoryBoards.push(`category-${c + 1}`);\n  }\n\n  const newState = { ...state,\n    days: days,\n    location: location,\n    places: placesFetched,\n    columns: { ...state.columns,\n      ...columns\n    },\n    dayBoards: [...dayBoards],\n    categoryBoards: [...categoryBoards]\n  }; // console.log(newState);\n\n  return newState;\n};","map":{"version":3,"sources":["/Users/wen/Desktop/Projects/React/travelPlanner/client/src/Store/placeReducer.js"],"names":["placeReducer","state","action","type","compiledData","days","location","search","placesLoaded","loadPlaces","extraDay","addExtraDay","newOrder","order","itinerary","payload","console","log","loadItinerary","columns","dayBoards","categoryBoards","placesFetched","googlePlacesApi","process","env","REACT_APP_GOOGLE_PLACES_API_KEY","dayPlans","i","length","dayObject","push","placeIds","j","response","fetch","data","json","placeObject","result","name","rating","photos","photo_reference","geometry","newState","city","places","nextColumnIndex","nextColumn","id","title","placeTypes","c","results","place_id"],"mappings":"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","sourcesContent":["export const placeReducer = (state, action) => {\n    switch (action.type) {\n        case 'SHOW_PLACES':\n            const { compiledData, days, location } = action.search;\n            const placesLoaded = loadPlaces(state, compiledData, days, location);\n            return placesLoaded;\n        case 'ADD_EXTRA_DAY':\n            const extraDay = addExtraDay(state);\n            return extraDay;\n        case 'CHANGE_ORDER':\n            const { newOrder } = action.order;\n            return newOrder;\n        case 'LOAD_ITINERARY':\n            const { itinerary } = action.payload\n            console.log(\"from reducer:\", itinerary);\n            loadItinerary(state, itinerary)\n            return state\n        default:\n            return state;\n    }\n}\n\nconst loadItinerary = async (state, itinerary ) => {\n\n    let columns = {};\n    let dayBoards = [];\n    let categoryBoards = [];\n    let placesFetched = {};\n\n    const googlePlacesApi = process.env.REACT_APP_GOOGLE_PLACES_API_KEY;\n    const dayPlans = itinerary.dayPlans;\n\n    for (var i = 0; i < dayPlans.length; i++) {\n        let dayObject = {};\n        dayObject['id'] = `day-${i}`;\n        dayObject['title'] = `Day ${i + 1}`;\n        dayObject['placeIds'] = [];\n\n        columns[`day-${i}`] = dayObject;\n        dayBoards.push(`day-${i}`);\n    }\n\n    for(var i = 0; i < dayPlans.length; i++) {\n        const placeIds = dayPlans[i].placeIds\n        columns[`day-${i}`].placeIds = placeIds\n        for(var j = 0; j < placeIds.length; j++){\n            const response = await fetch(`/place/details/json?placeid=${placeIds[j]}&key=${googlePlacesApi}`)\n            const data = await response.json();\n\n            let placeObject = {};\n            placeObject['id'] = placeIds[j]\n            placeObject['content'] = data.result.name;\n            placeObject['rating'] = data.result.rating;\n            placeObject['photoRef'] = data.result.photos ? data.result.photos[0].photo_reference : \"0\";\n            placeObject['location'] = data.result.geometry.location;\n            \n            //console.log(placeObject);\n            placesFetched[placeIds[j]] = placeObject;\n        }\n    }\n    //console.log(columns);\n    //console.log(placesFetched);\n\n    const newState = {\n        ...state,\n        days: dayPlans.length + 1,\n        location: itinerary.city,\n        places: placesFetched,\n        columns: {\n            ...state.columns,\n            ...columns,\n        },\n        dayBoards: [...dayBoards],\n        categoryBoards: [...categoryBoards],\n    }\n\n    console.log(newState)\n}\n\nconst addExtraDay = (state) => {\n\n    const nextColumnIndex = state.dayBoards.length;\n    const nextColumn = {\n        id: `day-${nextColumnIndex}`, \n        title: `Day ${nextColumnIndex + 1}`, \n        placeIds: []\n    }\n\n    const newState = {\n        ...state,\n        days: nextColumnIndex + 1,\n        columns: {\n            ...state.columns,\n            [`day-${nextColumnIndex}`]: nextColumn\n        },\n        dayBoards: [...state.dayBoards, `day-${nextColumnIndex}`],\n    }\n\n    console.log(newState);\n    return newState\n}\n\nconst loadPlaces = (state, compiledData, days, location) => {\n\n    let columns = {};\n    let dayBoards = [];\n    let categoryBoards = [];\n\n    for (var i = 0; i < days; i++) {\n        let dayObject = {};\n        dayObject['id'] = `day-${i}`;\n        dayObject['title'] = `Day ${i + 1}`;\n        dayObject['placeIds'] = [];\n\n        columns[`day-${i}`] = dayObject;\n        dayBoards.push(`day-${i}`);\n    }\n\n    let placesFetched = {};\n    const placeTypes = ['Restaurants', \"Hotels\", \"Tourist+attraction\"];\n    \n    for (var c = 0; c < compiledData.length; c++){\n\n        let data = compiledData[c];\n        let placeIds = [];\n\n        for (var j = 0; j < data.results.length; j++) {\n\n            //object structure of place card is set here\n    \n            var placeObject = {};\n            placeObject['id'] = data.results[j].place_id;\n            placeObject['content'] = data.results[j].name;\n            placeObject['rating'] = data.results[j].rating;\n            placeObject['photoRef'] = data.results[j].photos ? data.results[j].photos[0].photo_reference : \"0\";\n            placeObject['location'] = data.results[j].geometry.location;\n            \n            //console.log(placeObject);\n            placeIds.push(data.results[j].place_id);\n            placesFetched[data.results[j].place_id] = placeObject;\n        \n        }\n    \n        columns[`category-${c+1}`] = {\n            id: `category-${c+1}`,\n            title: `${placeTypes[c]}`,\n            placeIds: placeIds\n        }\n\n        categoryBoards.push(`category-${c+1}`);\n\n    } \n    \n    const newState = {\n        ...state,\n        days: days,\n        location: location,\n        places: placesFetched,\n        columns: {\n            ...state.columns,\n            ...columns,\n        },\n        dayBoards: [...dayBoards],\n        categoryBoards: [...categoryBoards],\n    }\n\n    // console.log(newState);\n    return newState;\n}"]},"metadata":{},"sourceType":"module"}